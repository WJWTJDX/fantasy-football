{% extends 'external/header.html' %}

{% block title %}Search | Fantasy Football Predictor{% endblock %}

{% load staticfiles %}
    {% block headercontent %}
        <h1>Search</h1>
        <h3>Type the full name of the player</h3>
        <h3 class="text-muted">Ex. "Russell Wilson"</h3>
        <br>
        <form action="results" id="searchform">
            <div class="form-inline">
            <div class="form-group">
                <input type="text" class="form-control" id="name" name="name" placeholder="Search" style="min-width: 300px;" required autofocus>
            </div>
            <button type="submit" class="btn btn-dark btn-md">Search</button>
            </div>
            <br>
            <div class="form-group">
                <h4 class="text-muted">Scoring Type</h4>
                <label class="radio-inline">
                    <input type="radio" name="scoring" id="standard" value="standard" checked> Standard
                </label>
                <label class="radio-inline">
                    <input type="radio" name="scoring" id="decimal" value="decimal"> Decimal
                </label>
                <label class="radio-inline">
                    <input type="radio" name="scoring" id="standard_ppr" value="standard_ppr"> Standard PPR
                </label>
                <label class="radio-inline">
                    <input type="radio" name="scoring" id="decimal_ppr" value="decimal_ppr"> Decimal PPR
                </label>
                <label class="radio-inline">
                    <input type="radio" name="scoring" id="standard_half_ppr" value="standard_half_ppr"> Standard Half PPR
                </label>
                <label class="radio-inline">
                    <input type="radio" name="scoring" id="decimal_half_ppr" value="decimal_half_ppr"> Decimal Half PPR
                </label>
            </div>
        </form>
        <br>
        <div class="modal">
        </div>
        <style>
            .modal {
                display: none;
                position: fixed;
                z-index: 1000;
                top: 0;
                left: 0;
                height: 100%;
                width: 100%;
                background: rgba( 255, 255, 255, .8 ) 
                            url("{% static 'img/loading.gif' %}") 
                            50% 50% 
                            no-repeat;
                }
            body.loading {
                overflow: hidden;   
            }
            body.loading .modal {
                display: block;
            }
        </style>
        {% endblock %}
{% block body %}
{% endblock %}
{% block scriptarea %}
    <script>
        $("#searchform").submit(function(event) {
            
            // stop form from submitting normally
            event.preventDefault();

            // get form data
            var $form = $( this );
            var url = $form.attr( "action" );
            // before send
            $("body").addClass("loading");
            
            var searchdata = $( "#searchform" ).serialize();
            // Send the data using get
            var posting = $.get(url , searchdata);

            /* Alerts the results */
            posting.done(function( data ) {
                // replace page content
                $("body").removeClass("loading");
                document.write(data)
                // change url
                var url = "/search/results/?"+searchdata;
                window.history.pushState({},"Results", url);
            });

        });
    </script>
{% endblock %}